	public void OnSessionStarting()
	{
		Game.instance.sessionManager.championship.GetCurrentEventDetails();
		switch (DesignDataManager.GetGameLength(false))
		{
		case PrefGameRaceLength.Type.Short:
			this.mRealSafetyCarCount = 1;
			break;
		case PrefGameRaceLength.Type.Medium:
			this.mRealSafetyCarCount = 2;
			break;
		case PrefGameRaceLength.Type.Long:
			this.mRealSafetyCarCount = 2147483647;
			break;
		}
		this.mSessionManager = Game.instance.sessionManager;
		this.mSafetyCar = Game.instance.vehicleManager.safetyVehicle;
		float random = RandomUtility.GetRandom01();
		int i;
		if (random > 0.95f)
		{
			i = 5;
		}
		else if (random > 0.9f)
		{
			i = 4;
		}
		else if (random > 0.8f)
		{
			i = 3;
		}
		else if (random > 0.5f)
		{
			i = 2;
		}
		else if (random > 0.25f)
		{
			i = 1;
		}
		else
		{
			i = 0;
		}
		bool flag = this.mSessionManager.currentSessionWeather.GetAverageWeather().rainType >= Weather.RainType.Heavy;
		if (flag && i < 4)
		{
			i += RandomUtility.GetRandom(0, 1);
		}
		this.mCrashChunks = new CrashDirector.CrashRaceChunk[10];
		for (int j = 0; j < this.mCrashChunks.Length; j++)
		{
			this.mCrashChunks[j] = new CrashDirector.CrashRaceChunk();
			this.mCrashChunks[j].normalizedChunkStart = (float)j / ((float)this.mCrashChunks.Length - 1f);
			this.mCrashChunks[j].normalizedChunkSize = 1f / ((float)this.mCrashChunks.Length - 1f);
		}
		Debug.LogFormat("Crashes for this race: {0} ", new object[]
		{
			i
		});
		while (i > 0)
		{
			i--;
			this.mCrashChunks[RandomUtility.GetRandom(0, this.mCrashChunks.Length)].crashCount++;
		}
		this.mVehiclesCantCrash.Clear();
	}